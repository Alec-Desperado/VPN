
# NAME: MainDirect
# UPDATED: 2025-05-19 21:57:05 UTC

[General]
# Workaround system. If you disable this option, it may cause some system issues such as delayed push notifications.
bypass-system = true

# Enable IPv6 support. false means not enabled, true means enabled.
ipv6 = true

# Prefer IPv6. Prioritize querying the IPv6 DNS server for AAAA records and using AAAA records first; false means not enabled.
prefer-ipv6 = false

# Private IP response. If this option is not enabled, domain name resolution returns a private IP address, and Shadowrocket will consider the domain name captured and force a proxy.
private-ip-answer = true

# The domain name resolves directly using system DNS; false means not enabled.
dns-direct-system = false

# Use system DNS after a DNS resolution failure; false means not enabled.
dns-fallback-system = false

# Use proxy server after direct connection domain name resolution fails; false means not enabled.
dns-direct-fallback-proxy = true

# Override DNS. Override the system default DNS using normal DNS or encrypted DNS (e.g. doh, doq, dot, etc.).
# Some DNS over https support http3, so try querying and switching to http3 if it is supported. You can add #no-h3 after the doh link to close it.
# Adguard DNS with ad blocking are used.
dns-server = https://1.1.1.1/dns-query,https://cloudflare-dns.com/dns-query,https://8.8.8.8/dns-query,https://dns.adguard-dns.com/dns-query,tls://dns.comss.one

# Alternate DNS. Returns to the backup DNS when the resolution of the overwritten DNS fails.
# If you need to specify multiple DNSs, you can separate them with commas. system means return to the system DNS.
# You can choose an alternative DOH/DOT - https://github.com/curl/curl/wiki/DNS-over-HTTPS
# fallback-dns-server = https://cloudflare-dns.com/dns-query, https://freedns.controld.com/p3
fallback-dns-server = https://cloudflare-dns.com/dns-query,https://unfiltered.adguard-dns.com/dns-query,https://1.1.1.1/dns-query,https://8.8.8.8/dns-query,tls://dns.comss.one,https://dns.comss.one/dns-query

# DNS Rewrite. Some devices or software always use hard-coded DNS servers, for example Netflix sends requests through Google DNS (8.8.8.8.8 or 8.8.4.4). You can use this option to intercept requests.
hijack-dns = :53,:853,8.8.8.8:53,8.8.8.8:853,8.8.4.4:53,8.8.4.4:853,

# Skip Proxy. This option forces the connection ranges for these domain names or IP addresses to be handled by the Shadowrocket TUN interface rather than by the Shadowrocket proxy server. This option is used to resolve some compatibility issues with some applications.
skip-proxy = 192.168.0.0/16,10.0.0.0/8,172.16.0.0/12,localhost,*.local,*.apple.com,*.icloud.com,captive.apple.com,*.tinkoff.ru,*.tinkoffjournal.ru,*.cdn-tinkoff.ru

# TUN Bypass Routing. The Shadowrocket TUN interface supports only the TCP protocol.
# Use this option to bypass the specified IP address range, allowing other protocols to pass through.
tun-excluded-routes = 10.0.0.0/8,100.64.0.0/10,127.0.0.0/8,169.254.0.0/16,172.16.0.0/12,192.0.0.0/24,192.0.2.0/24,192.88.99.0/24,192.168.0.0/16,198.51.100.0/24,203.0.113.0/24,224.0.0.0/4,255.255.255.255/32,239.255.255.250/32

# TUN contains routes. By default, the Shadowrocket interface announces itself as the default route, but because of the lesser routing of the Wi-Fi interface, some traffic may not pass through the Shadowrocket interface. Use this option to add a smaller routing table.
tun-included-routes =
# Always use a real IP address, this option requires Shadowrocket to process DNS queries in TUN and return a real IP address instead of a spoofed IP address.
always-real-ip = *.lan,*.local,geosite:private,time.*.com,ntp.*.com,*.cloudflareclient.com,localhost.sec.qq.com,localhost.ptlogin2.qq.com,localhost.work.weixin.qq.com,*.apple.com,*.icloud.com

# Ping packets automatically reply.
icmp-auto-reply = true

# If the REJECT policy is not enabled, by default it will take effect only in configuration mode. Once enabled, the policy can become effective in other global routing modes.
always-reject-url-rewrite = false

# If the UDP traffic matches a host policy that does not support UDP forwarding in rules, reselect the backup behavior. Additional behavior options include DIRECT and REJECT. DIRECT means forward UDP traffic directly, and REJECT means refuse to forward UDP traffic.
udp-policy-not-supported-behaviour = REJECT

# URL to update the configuration file
update-url = https://raw.githubusercontent.com/Alec-Desperado/VPN/refs/heads/main/MainDirect.conf

# Choose the fastest server for proxy
[Proxy Group]
# AUTO = url-test,interval=600,timeout=5,url=https://cp.cloudflare.com/generate_204,policy-regex-filter=*


# Optional. Add these addresses in the program settings Settings â†’ GeoLite2 Database
# If you do not have a Maxmind account and you are using the Proxy or Auto final rule
country: https://git.io/GeoLite2-Country.mmdb
asn: https://github.com/P3TERX/GeoLite.mmdb/raw/download/GeoLite2-ASN.mmdb


[Rule]

# Explanation for blocking UDP traffic on port 443: HTTP3/QUIC protocols are becoming popular, but domestic ISPs and international locations have low UDP priority, they don't work well and are blocked to force a return to HTTP2/HTTP1.1. (If you need to enable this logical rule, remove the # comment character before AND).
# AND,((PROTOCOL,UDP),(DST-PORT,443)),REJECT-NO-DROP

        

# Custom Rules
RULE-SET,https://raw.githubusercontent.com/Alec-Desperado/VPN/refs/heads/main/sr_ru_extended.list,PROXY

# Direct
RULE-SET,https://raw.githubusercontent.com/Alec-Desperado/VPN/refs/heads/main/domains/Lan.list,DIRECT
RULE-SET,https://raw.githubusercontent.com/Alec-Desperado/VPN/refs/heads/main/domains/private.list,DIRECT
RULE-SET,https://raw.githubusercontent.com/Alec-Desperado/VPN/refs/heads/main/domains/perplexity.list,DIRECT
RULE-SET,https://raw.githubusercontent.com/Alec-Desperado/VPN/refs/heads/main/domains/bitwarden.list,DIRECT
RULE-SET,https://raw.githubusercontent.com/Alec-Desperado/VPN/refs/heads/main/domains/reddit.list,DIRECT

# Apple
RULE-SET,https://raw.githubusercontent.com/Alec-Desperado/VPN/refs/heads/main/domains/apple.list,DIRECT
RULE-SET,https://raw.githubusercontent.com/Alec-Desperado/VPN/refs/heads/main/domains/AppleID.list,DIRECT
RULE-SET,https://raw.githubusercontent.com/Alec-Desperado/VPN/refs/heads/main/domains/apple-intelligence.list,DIRECT

RULE-SET,https://raw.githubusercontent.com/Alec-Desperado/VPN/refs/heads/main/domains/category-ntp.list,DIRECT
RULE-SET,https://raw.githubusercontent.com/Alec-Desperado/VPN/refs/heads/main/domains/category-ru.list,DIRECT

RULE-SET,https://raw.githubusercontent.com/Alec-Desperado/VPN/refs/heads/main/domains/bluesky.list,DIRECT
RULE-SET,https://raw.githubusercontent.com/Alec-Desperado/VPN/refs/heads/main/domains/telegram.list,DIRECT
RULE-SET,https://raw.githubusercontent.com/Alec-Desperado/VPN/refs/heads/main/domains/whatsapp.list,DIRECT

        

# AI
RULE-SET,https://raw.githubusercontent.com/Alec-Desperado/VPN/refs/heads/main/domains/cloudflare.list,PROXY
RULE-SET,https://raw.githubusercontent.com/Alec-Desperado/VPN/refs/heads/main/domains/Copilot.list,PROXY
RULE-SET,https://raw.githubusercontent.com/Alec-Desperado/VPN/refs/heads/main/domains/category-ai-!cn.list,PROXY
RULE-SET,https://raw.githubusercontent.com/Alec-Desperado/VPN/refs/heads/main/domains/category-social-media-!cn.list,PROXY
RULE-SET,https://raw.githubusercontent.com/Alec-Desperado/VPN/refs/heads/main/domains/category-entertainment.list,PROXY

RULE-SET,https://raw.githubusercontent.com/Alec-Desperado/VPN/refs/heads/main/domains/akamai.list,PROXY
RULE-SET,https://raw.githubusercontent.com/Alec-Desperado/VPN/refs/heads/main/domains/amazon.list,PROXY
RULE-SET,https://raw.githubusercontent.com/Alec-Desperado/VPN/refs/heads/main/domains/AmazonIP.list,PROXY
RULE-SET,https://raw.githubusercontent.com/Alec-Desperado/VPN/refs/heads/main/domains/azure.list,PROXY

RULE-SET,https://raw.githubusercontent.com/Alec-Desperado/VPN/refs/heads/main/domains/category-dev.list,PROXY
RULE-SET,https://raw.githubusercontent.com/Alec-Desperado/VPN/refs/heads/main/domains/DNS.list,PROXY
RULE-SET,https://raw.githubusercontent.com/Alec-Desperado/VPN/refs/heads/main/domains/category-ipfs.list,PROXY

RULE-SET,https://raw.githubusercontent.com/Alec-Desperado/VPN/refs/heads/main/domains/google.list,PROXY
RULE-SET,https://raw.githubusercontent.com/Alec-Desperado/VPN/refs/heads/main/domains/youtube.list,PROXY
RULE-SET,https://raw.githubusercontent.com/Alec-Desperado/VPN/refs/heads/main/domains/YouTubeMusic.list,PROXY

RULE-SET,https://raw.githubusercontent.com/Alec-Desperado/VPN/refs/heads/main/domains/atlassian.list,PROXY
RULE-SET,https://raw.githubusercontent.com/Alec-Desperado/VPN/refs/heads/main/domains/category-anticensorship.list,PROXY
RULE-SET,https://raw.githubusercontent.com/Alec-Desperado/VPN/refs/heads/main/domains/category-media-ru.list,PROXY
RULE-SET,https://raw.githubusercontent.com/Alec-Desperado/VPN/refs/heads/main/domains/category-speedtest.list,PROXY
RULE-SET,https://raw.githubusercontent.com/Alec-Desperado/VPN/refs/heads/main/domains/category-tech-media.list,PROXY
RULE-SET,https://raw.githubusercontent.com/Alec-Desperado/VPN/refs/heads/main/domains/dell.list,PROXY
RULE-SET,https://raw.githubusercontent.com/Alec-Desperado/VPN/refs/heads/main/domains/mikrotik.list,PROXY
RULE-SET,https://raw.githubusercontent.com/Alec-Desperado/VPN/refs/heads/main/domains/digitalocean.list,PROXY
RULE-SET,https://raw.githubusercontent.com/Alec-Desperado/VPN/refs/heads/main/domains/discord.list,PROXY  # IP?

RULE-SET,https://raw.githubusercontent.com/Alec-Desperado/VPN/refs/heads/main/domains/paypal.list,PROXY
RULE-SET,https://raw.githubusercontent.com/Alec-Desperado/VPN/refs/heads/main/domains/stripe.list,PROXY
RULE-SET,https://raw.githubusercontent.com/Alec-Desperado/VPN/refs/heads/main/domains/visa.list,PROXY
RULE-SET,https://raw.githubusercontent.com/Alec-Desperado/VPN/refs/heads/main/domains/squareup.list,PROXY

RULE-SET,https://raw.githubusercontent.com/Alec-Desperado/VPN/refs/heads/main/domains/rutracker.list,PROXY

# GeoIP
GEOIP,PRIVATE,DIRECT,no-resolve
GEOIP,RU,DIRECT,no-resolve
GEOSITE,RU,DIRECT,no-resolve

# Final routing rule
FINAL,DIRECT

        

[Host]
*.apple.com=server:system
*.cdn-apple.com=server:system
*.icloud.com=server:system
*.icloud-content.com=server:system
localhost = 127.0.0.1

[URL Rewrite]
^https?://(www.)?nnmclub.to https://nnmclub.to 302
^http://(www.)?yandex.ru https://www.ya.ru 302
^https?://(www.)?google.ru https://www.google.com 302
        
